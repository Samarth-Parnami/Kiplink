<!DOCTYPE html>
<html>
<head>
    <title>(Android)Aware Deeplinks using PageVisibility API</title>
</head>
<body>

   <script language="Javascript" type="text/javascript">
    let deeplink = "whatsapp://send?phone=+919779988030"
    let redirect = "https://play.google.com/store/apps/details?id=com.whatsapp&hl=en&gl=US"
   
    let state = false;
    document.addEventListener("visibilitychange", () => {
        if (document.hidden) {
            console.log("hidden");
            state = true;
        } else {
            console.log("visible");
        }
      });
    if(!state){
        console.log("opening deeplink");
        
        let anchor = document.createElement('a');
        anchor.href = deeplink;
        anchor.click();
    }
    setTimeout(()=>{
        console.log("Trying to open applink");
        if(!state){
            console.log("Opening applink");
            window.location.replace(redirect);
        }
    }, 3000);
        
    
    
   </script>
</body>
</html>
