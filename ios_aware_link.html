<!DOCTYPE html>
<html>
<head>
    <title>(iOS)Aware Deeplinks using PageVisibility API</title>
</head>
<body>

   <script language="Javascript" type="text/javascript">
    let deeplink = "photos-redirect://";
    let redirect = "https://apps.apple.com/in/app/whatsapp-messenger/id310633997";
   
    let state = false;
    document.addEventListener("visibilitychange", () => {
        if (document.hidden) {
            console.log("hidden");
            state = true;
        } else {
            state = false;
            console.log("visible");
        }
      });
    if(!state){
        console.log("opening deeplink");
        
        let anchor = document.createElement('a');
        anchor.href = deeplink;
        anchor.click();
    }
    setTimeout(()=>{
        console.log("Trying to open applink");
        if(!state){
            console.log("Opening applink");
            window.location.replace(redirect);
        }
    }, 3000);
        
    
    
   </script>
</body>
</html>
